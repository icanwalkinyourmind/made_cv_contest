#### Ход решене контеста:

1. Наткнулся на статью
[Cascade of Encoder-Decoder CNNs with Learned Coordinates Regressor for Robust Facial Landmarks Detection](https://www.researchgate.net/publication/336561437_Cascade_of_Encoder-Decoder_CNNs_with_Learned_Coordinates_Regressor_for_Robust_Facial_Landmarks_Detection)
2. Решил попробоать использовать для начала не каскад а одну пару encoder-decoder.
   (на этом решении в итоге и остановился)
3. Заменил последний слой в Unet из pytorch-segmentation-models на кастомный,
   с рассчётом на то, что после декодера получится heatmap
   из которо линейный слой вытащит координаты точек.
4. Перепробывал несколько энкодеров лучше всего сработал vgg16_bn.
   Это позволило в какой-то момент  побывать на 5 месте на паблик лидерборде.
5. Добвил рандомный (применялся с заданной вероятностью) поворот на 90 градусов
    для картинок, скор это не улучшило, пришлось отключить.
6. Пробовл использовать WingLoss  и AdaptiveWingLoss, комбинировал их с mse,
   эти манипуляции тоже ни к чему не приевли.
7. Пытался исопльзовать CoordConv слой [отсюда](https://github.com/mkocabas/CoordConv-pytorch),
   также безрезультатно
---
 
#### На что не было времени, но что по моему мнению помогло бы забраться повыше на лидерборде:

* Сбалансировать train выборку по положению головы, даже нашёл сетку которая умеет его определять
* Собрать ансамбль из нескольких моделей
* Делать рандомный поворот не на 90 градусов, а на 10-20

---

#### Для запуска:
* Установить requirements
* Создать симлинк на папку "data" в корне репозитория 

---

![submits](./kaggle_made_cv.png)
